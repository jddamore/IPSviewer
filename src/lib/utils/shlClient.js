var $t=Object.create;var tt=Object.defineProperty;var Gt=Object.getOwnPropertyDescriptor;var Vt=Object.getOwnPropertyNames;var zt=Object.getPrototypeOf,Yt=Object.prototype.hasOwnProperty;var qt=(t,e)=>()=>(t&&(e=t(t=0)),e);var V=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Xt=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Vt(e))!Yt.call(t,i)&&i!==r&&tt(t,i,{get:()=>e[i],enumerable:!(n=Gt(e,i))||n.enumerable});return t};var Zt=(t,e,r)=>(r=t!=null?$t(zt(t)):{},Xt(e||!t||!t.__esModule?tt(r,"default",{value:t,enumerable:!0}):r,t));var it=V(ue=>{"use strict";s();ue.byteLength=jt;ue.toByteArray=tr;ue.fromByteArray=ir;var W=[],B=[],Qt=typeof Uint8Array<"u"?Uint8Array:Array,We="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(O=0,rt=We.length;O<rt;++O)W[O]=We[O],B[We.charCodeAt(O)]=O;var O,rt;B["-".charCodeAt(0)]=62;B["_".charCodeAt(0)]=63;function nt(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function jt(t){var e=nt(t),r=e[0],n=e[1];return(r+n)*3/4-n}function er(t,e,r){return(e+r)*3/4-r}function tr(t){var e,r=nt(t),n=r[0],i=r[1],o=new Qt(er(t,n,i)),a=0,d=i>0?n-4:n,u;for(u=0;u<d;u+=4)e=B[t.charCodeAt(u)]<<18|B[t.charCodeAt(u+1)]<<12|B[t.charCodeAt(u+2)]<<6|B[t.charCodeAt(u+3)],o[a++]=e>>16&255,o[a++]=e>>8&255,o[a++]=e&255;return i===2&&(e=B[t.charCodeAt(u)]<<2|B[t.charCodeAt(u+1)]>>4,o[a++]=e&255),i===1&&(e=B[t.charCodeAt(u)]<<10|B[t.charCodeAt(u+1)]<<4|B[t.charCodeAt(u+2)]>>2,o[a++]=e>>8&255,o[a++]=e&255),o}function rr(t){return W[t>>18&63]+W[t>>12&63]+W[t>>6&63]+W[t&63]}function nr(t,e,r){for(var n,i=[],o=e;o<r;o+=3)n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(rr(n));return i.join("")}function ir(t){for(var e,r=t.length,n=r%3,i=[],o=16383,a=0,d=r-n;a<d;a+=o)i.push(nr(t,a,a+o>d?d:a+o));return n===1?(e=t[r-1],i.push(W[e>>2]+W[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(W[e>>10]+W[e>>4&63]+W[e<<2&63]+"=")),i.join("")}});var ot=V(Te=>{s();Te.read=function(t,e,r,n,i){var o,a,d=i*8-n-1,u=(1<<d)-1,m=u>>1,h=-7,f=r?i-1:0,g=r?-1:1,b=t[e+f];for(f+=g,o=b&(1<<-h)-1,b>>=-h,h+=d;h>0;o=o*256+t[e+f],f+=g,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=a*256+t[e+f],f+=g,h-=8);if(o===0)o=1-m;else{if(o===u)return a?NaN:(b?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-m}return(b?-1:1)*a*Math.pow(2,o-n)};Te.write=function(t,e,r,n,i,o){var a,d,u,m=o*8-i-1,h=(1<<m)-1,f=h>>1,g=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=n?0:o-1,$=n?1:-1,pe=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(d=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),a+f>=1?e+=g/u:e+=g*Math.pow(2,1-f),e*u>=2&&(a++,u/=2),a+f>=h?(d=0,a=h):a+f>=1?(d=(e*u-1)*Math.pow(2,i),a=a+f):(d=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[r+b]=d&255,b+=$,d/=256,i-=8);for(a=a<<i|d,m+=i;m>0;t[r+b]=a&255,b+=$,a/=256,m-=8);t[r+b-$]|=pe*128}});var xt=V(X=>{"use strict";s();var Ue=it(),Y=ot(),at=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;X.Buffer=c;X.SlowBuffer=dr;X.INSPECT_MAX_BYTES=50;var fe=2147483647;X.kMaxLength=fe;c.TYPED_ARRAY_SUPPORT=or();!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function or(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(!!c.isBuffer(this))return this.buffer}});Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(!!c.isBuffer(this))return this.byteOffset}});function U(t){if(t>fe)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Oe(t)}return dt(t,e,r)}c.poolSize=8192;function dt(t,e,r){if(typeof t=="string")return sr(t,e);if(ArrayBuffer.isView(t))return cr(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(T(t,ArrayBuffer)||t&&T(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(T(t,SharedArrayBuffer)||t&&T(t.buffer,SharedArrayBuffer)))return Re(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return c.from(n,e,r);let i=pr(t);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return c.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}c.from=function(t,e,r){return dt(t,e,r)};Object.setPrototypeOf(c.prototype,Uint8Array.prototype);Object.setPrototypeOf(c,Uint8Array);function ut(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function ar(t,e,r){return ut(t),t<=0?U(t):e!==void 0?typeof r=="string"?U(t).fill(e,r):U(t).fill(e):U(t)}c.alloc=function(t,e,r){return ar(t,e,r)};function Oe(t){return ut(t),U(t<0?0:Fe(t)|0)}c.allocUnsafe=function(t){return Oe(t)};c.allocUnsafeSlow=function(t){return Oe(t)};function sr(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=ft(t,e)|0,n=U(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function Je(t){let e=t.length<0?0:Fe(t.length)|0,r=U(e);for(let n=0;n<e;n+=1)r[n]=t[n]&255;return r}function cr(t){if(T(t,Uint8Array)){let e=new Uint8Array(t);return Re(e.buffer,e.byteOffset,e.byteLength)}return Je(t)}function Re(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,c.prototype),n}function pr(t){if(c.isBuffer(t)){let e=Fe(t.length)|0,r=U(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||Ne(t.length)?U(0):Je(t);if(t.type==="Buffer"&&Array.isArray(t.data))return Je(t.data)}function Fe(t){if(t>=fe)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+fe.toString(16)+" bytes");return t|0}function dr(t){return+t!=t&&(t=0),c.alloc(+t)}c.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==c.prototype};c.compare=function(e,r){if(T(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),T(r,Uint8Array)&&(r=c.from(r,r.offset,r.byteLength)),!c.isBuffer(e)||!c.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let n=e.length,i=r.length;for(let o=0,a=Math.min(n,i);o<a;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0};c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};c.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return c.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;let i=c.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){let a=e[n];if(T(a,Uint8Array))o+a.length>i.length?(c.isBuffer(a)||(a=c.from(a)),a.copy(i,o)):Uint8Array.prototype.set.call(i,a,o);else if(c.isBuffer(a))a.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=a.length}return i};function ft(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||T(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return De(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return At(t).length;default:if(i)return n?-1:De(t).length;e=(""+e).toLowerCase(),i=!0}}c.byteLength=ft;function ur(t,e,r){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return Ar(this,e,r);case"utf8":case"utf-8":return lt(this,e,r);case"ascii":return gr(this,e,r);case"latin1":case"binary":return Sr(this,e,r);case"base64":return wr(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xr(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}c.prototype._isBuffer=!0;function F(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}c.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)F(this,r,r+1);return this};c.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)F(this,r,r+3),F(this,r+1,r+2);return this};c.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)F(this,r,r+7),F(this,r+1,r+6),F(this,r+2,r+5),F(this,r+3,r+4);return this};c.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?lt(this,0,e):ur.apply(this,arguments)};c.prototype.toLocaleString=c.prototype.toString;c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:c.compare(this,e)===0};c.prototype.inspect=function(){let e="",r=X.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};at&&(c.prototype[at]=c.prototype.inspect);c.prototype.compare=function(e,r,n,i,o){if(T(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;let a=o-i,d=n-r,u=Math.min(a,d),m=this.slice(i,o),h=e.slice(r,n);for(let f=0;f<u;++f)if(m[f]!==h[f]){a=m[f],d=h[f];break}return a<d?-1:d<a?1:0};function ht(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Ne(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=c.from(e,n)),c.isBuffer(e))return e.length===0?-1:st(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):st(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function st(t,e,r,n,i){let o=1,a=t.length,d=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;o=2,a/=2,d/=2,r/=2}function u(h,f){return o===1?h[f]:h.readUInt16BE(f*o)}let m;if(i){let h=-1;for(m=r;m<a;m++)if(u(t,m)===u(e,h===-1?0:m-h)){if(h===-1&&(h=m),m-h+1===d)return h*o}else h!==-1&&(m-=m-h),h=-1}else for(r+d>a&&(r=a-d),m=r;m>=0;m--){let h=!0;for(let f=0;f<d;f++)if(u(t,m+f)!==u(e,f)){h=!1;break}if(h)return m}return-1}c.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};c.prototype.indexOf=function(e,r,n){return ht(this,e,r,n,!0)};c.prototype.lastIndexOf=function(e,r,n){return ht(this,e,r,n,!1)};function fr(t,e,r,n){r=Number(r)||0;let i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;let o=e.length;n>o/2&&(n=o/2);let a;for(a=0;a<n;++a){let d=parseInt(e.substr(a*2,2),16);if(Ne(d))return a;t[r+a]=d}return a}function hr(t,e,r,n){return he(De(e,t.length-r),t,r,n)}function lr(t,e,r,n){return he(Hr(e),t,r,n)}function mr(t,e,r,n){return he(At(e),t,r,n)}function yr(t,e,r,n){return he(Kr(e,t.length-r),t,r,n)}c.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-r;if((n===void 0||n>o)&&(n=o),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let a=!1;for(;;)switch(i){case"hex":return fr(this,e,r,n);case"utf8":case"utf-8":return hr(this,e,r,n);case"ascii":case"latin1":case"binary":return lr(this,e,r,n);case"base64":return mr(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return yr(this,e,r,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}};c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function wr(t,e,r){return e===0&&r===t.length?Ue.fromByteArray(t):Ue.fromByteArray(t.slice(e,r))}function lt(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let o=t[i],a=null,d=o>239?4:o>223?3:o>191?2:1;if(i+d<=r){let u,m,h,f;switch(d){case 1:o<128&&(a=o);break;case 2:u=t[i+1],(u&192)===128&&(f=(o&31)<<6|u&63,f>127&&(a=f));break;case 3:u=t[i+1],m=t[i+2],(u&192)===128&&(m&192)===128&&(f=(o&15)<<12|(u&63)<<6|m&63,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:u=t[i+1],m=t[i+2],h=t[i+3],(u&192)===128&&(m&192)===128&&(h&192)===128&&(f=(o&15)<<18|(u&63)<<12|(m&63)<<6|h&63,f>65535&&f<1114112&&(a=f))}}a===null?(a=65533,d=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|a&1023),n.push(a),i+=d}return Er(n)}var ct=4096;function Er(t){let e=t.length;if(e<=ct)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=ct));return r}function gr(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function Sr(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function Ar(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let o=e;o<r;++o)i+=Ir[t[o]];return i}function xr(t,e,r){let n=t.slice(e,r),i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}c.prototype.slice=function(e,r){let n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);let i=this.subarray(e,r);return Object.setPrototypeOf(i,c.prototype),i};function _(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||_(e,r,this.length);let i=this[e],o=1,a=0;for(;++a<r&&(o*=256);)i+=this[e+a]*o;return i};c.prototype.readUintBE=c.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||_(e,r,this.length);let i=this[e+--r],o=1;for(;r>0&&(o*=256);)i+=this[e+--r]*o;return i};c.prototype.readUint8=c.prototype.readUInt8=function(e,r){return e=e>>>0,r||_(e,1,this.length),this[e]};c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||_(e,2,this.length),this[e]|this[e+1]<<8};c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||_(e,2,this.length),this[e]<<8|this[e+1]};c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||_(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||_(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};c.prototype.readBigUInt64LE=R(function(e){e=e>>>0,q(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&re(e,this.length-8);let i=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});c.prototype.readBigUInt64BE=R(function(e){e=e>>>0,q(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&re(e,this.length-8);let i=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});c.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||_(e,r,this.length);let i=this[e],o=1,a=0;for(;++a<r&&(o*=256);)i+=this[e+a]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*r)),i};c.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||_(e,r,this.length);let i=r,o=1,a=this[e+--i];for(;i>0&&(o*=256);)a+=this[e+--i]*o;return o*=128,a>=o&&(a-=Math.pow(2,8*r)),a};c.prototype.readInt8=function(e,r){return e=e>>>0,r||_(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};c.prototype.readInt16LE=function(e,r){e=e>>>0,r||_(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};c.prototype.readInt16BE=function(e,r){e=e>>>0,r||_(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};c.prototype.readInt32LE=function(e,r){return e=e>>>0,r||_(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};c.prototype.readInt32BE=function(e,r){return e=e>>>0,r||_(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};c.prototype.readBigInt64LE=R(function(e){e=e>>>0,q(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&re(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});c.prototype.readBigInt64BE=R(function(e){e=e>>>0,q(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&re(e,this.length-8);let i=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});c.prototype.readFloatLE=function(e,r){return e=e>>>0,r||_(e,4,this.length),Y.read(this,e,!0,23,4)};c.prototype.readFloatBE=function(e,r){return e=e>>>0,r||_(e,4,this.length),Y.read(this,e,!1,23,4)};c.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||_(e,8,this.length),Y.read(this,e,!0,52,8)};c.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||_(e,8,this.length),Y.read(this,e,!1,52,8)};function H(t,e,r,n,i,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let d=Math.pow(2,8*n)-1;H(this,e,r,n,d,0)}let o=1,a=0;for(this[r]=e&255;++a<n&&(o*=256);)this[r+a]=e/o&255;return r+n};c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let d=Math.pow(2,8*n)-1;H(this,e,r,n,d,0)}let o=n-1,a=1;for(this[r+o]=e&255;--o>=0&&(a*=256);)this[r+o]=e/a&255;return r+n};c.prototype.writeUint8=c.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,1,255,0),this[r]=e&255,r+1};c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function mt(t,e,r,n,i){St(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o;let a=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=a,a=a>>8,t[r++]=a,a=a>>8,t[r++]=a,a=a>>8,t[r++]=a,r}function yt(t,e,r,n,i){St(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r+7]=o,o=o>>8,t[r+6]=o,o=o>>8,t[r+5]=o,o=o>>8,t[r+4]=o;let a=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=a,a=a>>8,t[r+2]=a,a=a>>8,t[r+1]=a,a=a>>8,t[r]=a,r+8}c.prototype.writeBigUInt64LE=R(function(e,r=0){return mt(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});c.prototype.writeBigUInt64BE=R(function(e,r=0){return yt(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});c.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let u=Math.pow(2,8*n-1);H(this,e,r,n,u-1,-u)}let o=0,a=1,d=0;for(this[r]=e&255;++o<n&&(a*=256);)e<0&&d===0&&this[r+o-1]!==0&&(d=1),this[r+o]=(e/a>>0)-d&255;return r+n};c.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let u=Math.pow(2,8*n-1);H(this,e,r,n,u-1,-u)}let o=n-1,a=1,d=0;for(this[r+o]=e&255;--o>=0&&(a*=256);)e<0&&d===0&&this[r+o+1]!==0&&(d=1),this[r+o]=(e/a>>0)-d&255;return r+n};c.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};c.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};c.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};c.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};c.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||H(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};c.prototype.writeBigInt64LE=R(function(e,r=0){return mt(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});c.prototype.writeBigInt64BE=R(function(e,r=0){return yt(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function wt(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Et(t,e,r,n,i){return e=+e,r=r>>>0,i||wt(t,e,r,4,34028234663852886e22,-34028234663852886e22),Y.write(t,e,r,n,23,4),r+4}c.prototype.writeFloatLE=function(e,r,n){return Et(this,e,r,!0,n)};c.prototype.writeFloatBE=function(e,r,n){return Et(this,e,r,!1,n)};function gt(t,e,r,n,i){return e=+e,r=r>>>0,i||wt(t,e,r,8,17976931348623157e292,-17976931348623157e292),Y.write(t,e,r,n,52,8),r+8}c.prototype.writeDoubleLE=function(e,r,n){return gt(this,e,r,!0,n)};c.prototype.writeDoubleBE=function(e,r,n){return gt(this,e,r,!1,n)};c.prototype.copy=function(e,r,n,i){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);let o=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),o};c.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let a=e.charCodeAt(0);(i==="utf8"&&a<128||i==="latin1")&&(e=a)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let o;if(typeof e=="number")for(o=r;o<n;++o)this[o]=e;else{let a=c.isBuffer(e)?e:c.from(e,i),d=a.length;if(d===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-r;++o)this[o+r]=a[o%d]}return this};var z={};function Me(t,e,r){z[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}Me("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Me("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);Me("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=pt(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=pt(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function pt(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function br(t,e,r){q(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&re(e,t.length-(r+1))}function St(t,e,r,n,i,o){if(t>r||t<e){let a=typeof e=="bigint"?"n":"",d;throw o>3?e===0||e===BigInt(0)?d=`>= 0${a} and < 2${a} ** ${(o+1)*8}${a}`:d=`>= -(2${a} ** ${(o+1)*8-1}${a}) and < 2 ** ${(o+1)*8-1}${a}`:d=`>= ${e}${a} and <= ${r}${a}`,new z.ERR_OUT_OF_RANGE("value",d,t)}br(n,i,o)}function q(t,e){if(typeof t!="number")throw new z.ERR_INVALID_ARG_TYPE(e,"number",t)}function re(t,e,r){throw Math.floor(t)!==t?(q(t,r),new z.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new z.ERR_BUFFER_OUT_OF_BOUNDS:new z.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var _r=/[^+/0-9A-Za-z-_]/g;function Cr(t){if(t=t.split("=")[0],t=t.trim().replace(_r,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function De(t,e){e=e||1/0;let r,n=t.length,i=null,o=[];for(let a=0;a<n;++a){if(r=t.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(a+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function Hr(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function Kr(t,e){let r,n,i,o=[];for(let a=0;a<t.length&&!((e-=2)<0);++a)r=t.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function At(t){return Ue.toByteArray(Cr(t))}function he(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function T(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function Ne(t){return t!==t}var Ir=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=r*16;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function R(t){return typeof BigInt>"u"?Pr:t}function Pr(){throw new Error("BigInt not supported")}});var p,s=qt(()=>{p=xt().Buffer});var bt=V(Le=>{"use strict";s();Object.defineProperty(Le,"__esModule",{value:!0});function Br(t){var e=4,r=t.length,n=r%e;if(!n)return t;var i=r,o=e-n,a=r+o,d=p.alloc(a);for(d.write(t);o--;)d.write("=",i++);return d.toString()}Le.default=Br});var Ct=V(Ge=>{"use strict";s();Object.defineProperty(Ge,"__esModule",{value:!0});var vr=bt();function _t(t,e){return e===void 0&&(e="utf8"),p.isBuffer(t)?ke(t.toString("base64")):ke(p.from(t,e).toString("base64"))}function Wr(t,e){return e===void 0&&(e="utf8"),p.from($e(t),"base64").toString(e)}function $e(t){return t=t.toString(),vr.default(t).replace(/\-/g,"+").replace(/_/g,"/")}function ke(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Tr(t){return p.from($e(t),"base64")}var Z=_t;Z.encode=_t;Z.decode=Wr;Z.toBase64=$e;Z.fromBase64=ke;Z.toBuffer=Tr;Ge.default=Z});var Ht=V((Dn,le)=>{s();le.exports=Ct().default;le.exports.default=le.exports});s();var te=Zt(Ht(),1);s();s();s();s();s();s();s();var w=crypto;function C(t){try{return t!=null&&typeof t.extractable=="boolean"&&typeof t.algorithm.name=="string"&&typeof t.type=="string"}catch{return!1}}var Ur=async(t,e)=>{let r=`SHA-${t.slice(-3)}`;return new Uint8Array(await w.subtle.digest(r,e))},me=Ur;var K=new TextEncoder,I=new TextDecoder,ye=2**32;function P(...t){let e=t.reduce((i,{length:o})=>i+o,0),r=new Uint8Array(e),n=0;return t.forEach(i=>{r.set(i,n),n+=i.length}),r}function Kt(t,e){return P(K.encode(t),new Uint8Array([0]),e)}function Ve(t,e,r){if(e<0||e>=ye)throw new RangeError(`value must be >= 0 and <= ${ye-1}. Received ${e}`);t.set([e>>>24,e>>>16,e>>>8,e&255],r)}function ze(t){let e=Math.floor(t/ye),r=t%ye,n=new Uint8Array(8);return Ve(n,e,0),Ve(n,r,4),n}function we(t){let e=new Uint8Array(4);return Ve(e,t),e}function Ee(t){return P(we(t.length),t)}async function It(t,e,r){let n=Math.ceil((e>>3)/32),i;for(let o=1;o<=n;o++){let a=new Uint8Array(4+t.length+r.length);a.set(we(o)),a.set(t,4),a.set(r,4+t.length),i?i=P(i,await me("sha256",a)):i=await me("sha256",a)}return i=i.slice(0,e>>3),i}var Pt=t=>new Uint8Array(atob(t).split("").map(e=>e.charCodeAt(0))),S=t=>{let e=t;e instanceof Uint8Array&&(e=I.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return Pt(e)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}};s();s();s();var M=class extends Error{constructor(e){var r;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,this.constructor)}static get code(){return"ERR_JOSE_GENERIC"}};var Q=class extends M{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}},y=class extends M{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}},N=class extends M{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}},l=class extends M{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}};s();s();var ne=w.getRandomValues.bind(w);function vt(t){switch(t){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new y(`Unsupported JWE Algorithm: ${t}`)}}var Rr=(t,e)=>{if(e.length<<3!==vt(t))throw new l("Invalid Initialization Vector length")},Ye=Rr;s();var Dr=(t,e)=>{if(t.length<<3!==e)throw new l("Invalid Content Encryption Key length")},ge=Dr;s();var Or=(t,e)=>{if(!(t instanceof Uint8Array))throw new TypeError("First argument must be a buffer");if(!(e instanceof Uint8Array))throw new TypeError("Second argument must be a buffer");if(t.length!==e.length)throw new TypeError("Input buffers must have the same length");let r=t.length,n=0,i=-1;for(;++i<r;)n|=t[i]^e[i];return n===0},Wt=Or;s();s();function L(){return typeof WebSocketPair=="function"}function k(){try{return process.versions.node!==void 0}catch{return!1}}function D(t,e="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${e} must be ${t}`)}function ie(t,e){return t.name===e}function Fr(t){return parseInt(t.name.slice(4),10)}function Mr(t,e){if(e.length&&!e.some(r=>t.usages.includes(r))){let r="CryptoKey does not support this operation, its usages must include ";if(e.length>2){let n=e.pop();r+=`one of ${e.join(", ")}, or ${n}.`}else e.length===2?r+=`one of ${e[0]} or ${e[1]}.`:r+=`${e[0]}.`;throw new TypeError(r)}}function v(t,e,...r){switch(e){case"A128GCM":case"A192GCM":case"A256GCM":{if(!ie(t.algorithm,"AES-GCM"))throw D("AES-GCM");let n=parseInt(e.slice(1,4),10);if(t.algorithm.length!==n)throw D(n,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!ie(t.algorithm,"AES-KW"))throw D("AES-KW");let n=parseInt(e.slice(1,4),10);if(t.algorithm.length!==n)throw D(n,"algorithm.length");break}case"ECDH":if(!ie(t.algorithm,"ECDH"))throw D("ECDH");break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!ie(t.algorithm,"PBKDF2"))throw D("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!ie(t.algorithm,"RSA-OAEP"))throw D("RSA-OAEP");let n=parseInt(e.slice(9),10)||1;if(Fr(t.algorithm.hash)!==n)throw D(`SHA-${n}`,"algorithm.hash");break}default:throw new TypeError("CryptoKey does not support this operation")}Mr(t,r)}s();var A=(t,...e)=>{let r="Key must be ";if(e.length>2){let n=e.pop();r+=`one of type ${e.join(", ")}, or ${n}.`}else e.length===2?r+=`one of type ${e[0]} or ${e[1]}.`:r+=`of type ${e[0]}.`;return t==null?r+=` Received ${t}`:typeof t=="function"&&t.name?r+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor&&t.constructor.name&&(r+=` Received an instance of ${t.constructor.name}`),r};s();var qe=t=>C(t),E=["CryptoKey"];async function Nr(t,e,r,n,i,o){if(!(e instanceof Uint8Array))throw new TypeError(A(e,"Uint8Array"));let a=parseInt(t.slice(1,4),10),d=await w.subtle.importKey("raw",e.subarray(a>>3),"AES-CBC",!1,["decrypt"]),u=await w.subtle.importKey("raw",e.subarray(0,a>>3),{hash:`SHA-${a<<1}`,name:"HMAC"},!1,["sign"]),m=P(o,n,r,ze(o.length<<3)),h=new Uint8Array((await w.subtle.sign("HMAC",u,m)).slice(0,a>>3)),f;try{f=Wt(i,h)}catch{}if(!f)throw new N;let g;try{g=new Uint8Array(await w.subtle.decrypt({iv:n,name:"AES-CBC"},d,r))}catch{}if(!g)throw new N;return g}async function Lr(t,e,r,n,i,o){let a;e instanceof Uint8Array?a=await w.subtle.importKey("raw",e,"AES-GCM",!1,["decrypt"]):(v(e,t,"decrypt"),a=e);try{return new Uint8Array(await w.subtle.decrypt({additionalData:o,iv:n,name:"AES-GCM",tagLength:128},a,P(r,i)))}catch{throw new N}}var kr=async(t,e,r,n,i,o)=>{if(!C(e)&&!(e instanceof Uint8Array))throw new TypeError(A(e,...E,"Uint8Array"));switch(Ye(t,n),t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return e instanceof Uint8Array&&ge(e,parseInt(t.slice(-3),10)),Nr(t,e,r,n,i,o);case"A128GCM":case"A192GCM":case"A256GCM":return e instanceof Uint8Array&&ge(e,parseInt(t.slice(1,4),10)),Lr(t,e,r,n,i,o);default:throw new y("Unsupported JWE Content Encryption Algorithm")}},Se=kr;s();var Tt=async()=>{throw new y('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `inflateRaw` decrypt option to provide Inflate Raw implementation.')};s();var $r=(...t)=>{let e=t.filter(Boolean);if(e.length===0||e.length===1)return!0;let r;for(let n of e){let i=Object.keys(n);if(!r||r.size===0){r=new Set(i);continue}for(let o of i){if(r.has(o))return!1;r.add(o)}}return!0},j=$r;s();function Gr(t){return typeof t=="object"&&t!==null}function x(t){if(!Gr(t)||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}s();s();s();var Vr=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]],Ae=Vr;function zr(t,e){if(t.algorithm.length!==parseInt(e.slice(1,4),10))throw new TypeError(`Invalid key size for alg: ${e}`)}function Yr(t,e,r){if(C(t))return v(t,e,r),t;if(t instanceof Uint8Array)return w.subtle.importKey("raw",t,"AES-KW",!0,[r]);throw new TypeError(A(t,...E,"Uint8Array"))}var oe=async(t,e,r)=>{let n=await Yr(e,t,"unwrapKey");zr(n,t);let i=await w.subtle.unwrapKey("raw",r,n,"AES-KW",...Ae);return new Uint8Array(await w.subtle.exportKey("raw",i))};s();async function Xe(t,e,r,n,i=new Uint8Array(0),o=new Uint8Array(0)){if(!C(t))throw new TypeError(A(t,...E));if(v(t,"ECDH"),!C(e))throw new TypeError(A(e,...E));v(e,"ECDH","deriveBits");let a=P(Ee(K.encode(r)),Ee(i),Ee(o),we(n)),d=new Uint8Array(await w.subtle.deriveBits({name:"ECDH",public:t},e,Math.ceil(parseInt(e.algorithm.namedCurve.slice(-3),10)/8)<<3));return It(d,n,a)}function Ze(t){if(!C(t))throw new TypeError(A(t,...E));return["P-256","P-384","P-521"].includes(t.algorithm.namedCurve)}s();s();function Qe(t){if(!(t instanceof Uint8Array)||t.length<8)throw new l("PBES2 Salt Input must be 8 or more octets")}function Xr(t,e){if(t instanceof Uint8Array)return w.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits"]);if(C(t))return v(t,e,"deriveBits","deriveKey"),t;throw new TypeError(A(t,...E,"Uint8Array"))}async function Zr(t,e,r,n){Qe(t);let i=Kt(e,t),o=parseInt(e.slice(13,16),10),a={hash:`SHA-${e.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:i},d={length:o,name:"AES-KW"},u=await Xr(n,e);if(u.usages.includes("deriveBits"))return new Uint8Array(await w.subtle.deriveBits(a,u,o));if(u.usages.includes("deriveKey"))return w.subtle.deriveKey(a,u,d,!1,["wrapKey","unwrapKey"]);throw new TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"')}var Jt=async(t,e,r,n,i)=>{let o=await Zr(i,t,n,e);return oe(t.slice(-6),o,r)};s();s();function xe(t){switch(t){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new y(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}s();var be=(t,e)=>{if(t.startsWith("RS")||t.startsWith("PS")){let{modulusLength:r}=e.algorithm;if(typeof r!="number"||r<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}};var Rt=async(t,e,r)=>{if(!C(e))throw new TypeError(A(e,...E));if(v(e,t,"decrypt","unwrapKey"),be(t,e),e.usages.includes("decrypt"))return new Uint8Array(await w.subtle.decrypt(xe(t),e,r));if(e.usages.includes("unwrapKey")){let n=await w.subtle.unwrapKey("raw",r,e,xe(t),...Ae);return new Uint8Array(await w.subtle.exportKey("raw",n))}throw new TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation')};s();function _e(t){switch(t){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new y(`Unsupported JWE Algorithm: ${t}`)}}var Ce=t=>ne(new Uint8Array(_e(t)>>3));s();s();s();s();function en(t){let e,r;switch(t.kty){case"oct":{switch(t.alg){case"HS256":case"HS384":case"HS512":e={name:"HMAC",hash:`SHA-${t.alg.slice(-3)}`},r=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new y(`${t.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":e={name:"AES-GCM"},r=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":e={name:"AES-KW"},r=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":e={name:"PBKDF2"},r=["deriveBits"];break;default:throw new y('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"RSA":{switch(t.alg){case"PS256":case"PS384":case"PS512":e={name:"RSA-PSS",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":e={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":e={name:"RSA-OAEP",hash:`SHA-${parseInt(t.alg.slice(-3),10)||1}`},r=t.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new y('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(t.alg){case"ES256":e={name:"ECDSA",namedCurve:"P-256"},r=t.d?["sign"]:["verify"];break;case"ES384":e={name:"ECDSA",namedCurve:"P-384"},r=t.d?["sign"]:["verify"];break;case"ES512":e={name:"ECDSA",namedCurve:"P-521"},r=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:"ECDH",namedCurve:t.crv},r=t.d?["deriveBits"]:[];break;default:throw new y('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case((L()||k())&&"OKP"):if(t.alg!=="EdDSA")throw new y('Invalid or unsupported JWK "alg" (Algorithm) Parameter value');switch(t.crv){case"Ed25519":e={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},r=t.d?["sign"]:["verify"];break;case(k()&&"Ed448"):e={name:"NODE-ED448",namedCurve:"NODE-ED448"},r=t.d?["sign"]:["verify"];break;default:throw new y('Invalid or unsupported JWK "crv" (Subtype of Key Pair) Parameter value')}break;default:throw new y('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:e,keyUsages:r}}var tn=async t=>{var e,r;let{algorithm:n,keyUsages:i}=en(t),o=[n,(e=t.ext)!==null&&e!==void 0?e:!1,(r=t.key_ops)!==null&&r!==void 0?r:i];if(n.name==="PBKDF2")return w.subtle.importKey("raw",S(t.k),...o);let a={...t};return delete a.alg,w.subtle.importKey("jwk",a,...o)},je=tn;async function ae(t,e,r){if(!x(t))throw new TypeError("JWK must be an object");if(e||(e=t.alg),typeof e!="string"||!e)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');switch(t.kty){case"oct":if(typeof t.k!="string"||!t.k)throw new TypeError('missing "k" (Key Value) Parameter value');return r??(r=t.ext!==!0),r?je({...t,alg:e,ext:!1}):S(t.k);case"RSA":if(t.oth!==void 0)throw new y('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return je({...t,alg:e});default:throw new y('Unsupported "kty" (Key Type) Parameter value')}}s();var rn=t=>{if(!(t instanceof Uint8Array)){if(!qe(t))throw new TypeError(A(t,...E,"Uint8Array"));if(t.type!=="secret")throw new TypeError(`${E.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},nn=(t,e)=>{if(!qe(t))throw new TypeError(A(t,...E));if(t.type==="secret")throw new TypeError(`${E.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if(e==="sign"&&t.type==="public")throw new TypeError(`${E.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if(e==="decrypt"&&t.type==="public")throw new TypeError(`${E.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&e==="verify"&&t.type==="private")throw new TypeError(`${E.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&e==="encrypt"&&t.type==="private")throw new TypeError(`${E.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)},on=(t,e,r)=>{t.startsWith("HS")||t==="dir"||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?rn(e):nn(e,r)},se=on;s();s();async function Dt(t,e,r,n,i){let o=t.slice(0,7);return Se(o,e,r,n,i,new Uint8Array(0))}async function cn(t,e,r,n){switch(se(t,e,"decrypt"),t){case"dir":{if(r!==void 0)throw new l("Encountered unexpected JWE Encrypted Key");return e}case"ECDH-ES":if(r!==void 0)throw new l("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!x(n.epk))throw new l('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!Ze(e))throw new y("ECDH with the provided key is not allowed or not supported by your javascript runtime");let i=await ae(n.epk,t),o,a;if(n.apu!==void 0){if(typeof n.apu!="string")throw new l('JOSE Header "apu" (Agreement PartyUInfo) invalid');o=S(n.apu)}if(n.apv!==void 0){if(typeof n.apv!="string")throw new l('JOSE Header "apv" (Agreement PartyVInfo) invalid');a=S(n.apv)}let d=await Xe(i,e,t==="ECDH-ES"?n.enc:t,t==="ECDH-ES"?_e(n.enc):parseInt(t.slice(-5,-2),10),o,a);if(t==="ECDH-ES")return d;if(r===void 0)throw new l("JWE Encrypted Key missing");return oe(t.slice(-6),d,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(r===void 0)throw new l("JWE Encrypted Key missing");return Rt(t,e,r)}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(r===void 0)throw new l("JWE Encrypted Key missing");if(typeof n.p2c!="number")throw new l('JOSE Header "p2c" (PBES2 Count) missing or invalid');if(typeof n.p2s!="string")throw new l('JOSE Header "p2s" (PBES2 Salt) missing or invalid');return Jt(t,e,r,n.p2c,S(n.p2s))}case"A128KW":case"A192KW":case"A256KW":{if(r===void 0)throw new l("JWE Encrypted Key missing");return oe(t,e,r)}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(r===void 0)throw new l("JWE Encrypted Key missing");if(typeof n.iv!="string")throw new l('JOSE Header "iv" (Initialization Vector) missing or invalid');if(typeof n.tag!="string")throw new l('JOSE Header "tag" (Authentication Tag) missing or invalid');let i=S(n.iv),o=S(n.tag);return Dt(t,e,r,i,o)}default:throw new y('Invalid or unsupported "alg" (JWE Algorithm) header value')}}var Ot=cn;s();function pn(t,e,r,n,i){if(i.crit!==void 0&&n.crit===void 0)throw new t('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||n.crit===void 0)return new Set;if(!Array.isArray(n.crit)||n.crit.length===0||n.crit.some(a=>typeof a!="string"||a.length===0))throw new t('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;r!==void 0?o=new Map([...Object.entries(r),...e.entries()]):o=e;for(let a of n.crit){if(!o.has(a))throw new y(`Extension Header Parameter "${a}" is not recognized`);if(i[a]===void 0)throw new t(`Extension Header Parameter "${a}" is missing`);if(o.get(a)&&n[a]===void 0)throw new t(`Extension Header Parameter "${a}" MUST be integrity protected`)}return new Set(n.crit)}var ee=pn;s();var dn=(t,e)=>{if(e!==void 0&&(!Array.isArray(e)||e.some(r=>typeof r!="string")))throw new TypeError(`"${t}" option must be an array of strings`);if(!!e)return new Set(e)},He=dn;async function Ke(t,e,r){var n;if(!x(t))throw new l("Flattened JWE must be an object");if(t.protected===void 0&&t.header===void 0&&t.unprotected===void 0)throw new l("JOSE Header missing");if(typeof t.iv!="string")throw new l("JWE Initialization Vector missing or incorrect type");if(typeof t.ciphertext!="string")throw new l("JWE Ciphertext missing or incorrect type");if(typeof t.tag!="string")throw new l("JWE Authentication Tag missing or incorrect type");if(t.protected!==void 0&&typeof t.protected!="string")throw new l("JWE Protected Header incorrect type");if(t.encrypted_key!==void 0&&typeof t.encrypted_key!="string")throw new l("JWE Encrypted Key incorrect type");if(t.aad!==void 0&&typeof t.aad!="string")throw new l("JWE AAD incorrect type");if(t.header!==void 0&&!x(t.header))throw new l("JWE Shared Unprotected Header incorrect type");if(t.unprotected!==void 0&&!x(t.unprotected))throw new l("JWE Per-Recipient Unprotected Header incorrect type");let i;if(t.protected){let de=S(t.protected);try{i=JSON.parse(I.decode(de))}catch{throw new l("JWE Protected Header is invalid")}}if(!j(i,t.header,t.unprotected))throw new l("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let o={...i,...t.header,...t.unprotected};if(ee(l,new Map,r?.crit,i,o),o.zip!==void 0){if(!i||!i.zip)throw new l('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if(o.zip!=="DEF")throw new y('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:a,enc:d}=o;if(typeof a!="string"||!a)throw new l("missing JWE Algorithm (alg) in JWE Header");if(typeof d!="string"||!d)throw new l("missing JWE Encryption Algorithm (enc) in JWE Header");let u=r&&He("keyManagementAlgorithms",r.keyManagementAlgorithms),m=r&&He("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(u&&!u.has(a))throw new Q('"alg" (Algorithm) Header Parameter not allowed');if(m&&!m.has(d))throw new Q('"enc" (Encryption Algorithm) Header Parameter not allowed');let h;t.encrypted_key!==void 0&&(h=S(t.encrypted_key));let f=!1;typeof e=="function"&&(e=await e(i,t),f=!0);let g;try{g=await Ot(a,e,h,o)}catch(de){if(de instanceof TypeError)throw de;g=Ce(d)}let b=S(t.iv),$=S(t.tag),pe=K.encode((n=t.protected)!==null&&n!==void 0?n:""),Be;t.aad!==void 0?Be=P(pe,K.encode("."),K.encode(t.aad)):Be=pe;let ve=await Se(d,g,S(t.ciphertext),b,$,Be);o.zip==="DEF"&&(ve=await(r?.inflateRaw||Tt)(ve));let G={plaintext:ve};return t.protected!==void 0&&(G.protectedHeader=i),t.aad!==void 0&&(G.additionalAuthenticatedData=S(t.aad)),t.unprotected!==void 0&&(G.sharedUnprotectedHeader=t.unprotected),t.header!==void 0&&(G.unprotectedHeader=t.header),f?{...G,key:e}:G}async function Ie(t,e,r){if(t instanceof Uint8Array&&(t=I.decode(t)),typeof t!="string")throw new l("Compact JWE must be a string or Uint8Array");let{0:n,1:i,2:o,3:a,4:d,length:u}=t.split(".");if(u!==5)throw new l("Invalid Compact JWE");let m=await Ke({ciphertext:a,iv:o||void 0,protected:n||void 0,tag:d||void 0,encrypted_key:i||void 0},e,r),h={plaintext:m.plaintext,protectedHeader:m.protectedHeader};return typeof e=="function"?{...h,key:m.key}:h}s();s();s();s();s();s();var hn=Symbol();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();s();function Nd(t){let e=new Uint8Array(t);return crypto.getRandomValues(e),te.default.encode(e.buffer)}function et(t){return JSON.parse(te.default.decode(t))}function Ld(t){return JSON.parse(new TextDecoder().decode(t))}function kd(t){let e=t.shl.split(/^(?:.+:\/.+#)?shlink:\//)[1];return et(e)?.flag}function $d(t){let e=t.shl.split(/^(?:.+:\/.+#)?shlink:\//)[1],r=et(e);return new URL(r?.url).href.split("/").pop()}async function Gd(t){let e=t.state?JSON.parse(te.default.decode(t.state)):t,r=e.shl.split(/^(?:.+:\/.+#)?shlink:\//)[1],n=et(r),i=await fetch(n.url,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({passcode:e.passcode,recipient:e.recipient})}),o=!1,a;a=await i.text();try{a=JSON.parse(a),o=!0}catch{console.warn("Manifest did not return JSON object")}if(!i.ok||!o)return{status:i.status,error:a??""};{let d=a.files.filter(g=>g.contentType==="application/smart-health-card").map(async g=>g.embedded!==void 0?g.embedded:fetch(g.location).then(b=>b.text())),u=te.default.toBuffer(n.key),m=d.map(async g=>{let b=await Ie(await g,u);return new TextDecoder().decode(b.plaintext)});return{shcs:(await Promise.all(m)).flatMap(g=>JSON.parse(g).verifiableCredential),state:te.default.encode(JSON.stringify(e))}}}export{et as decodeBase64urlToJson,Ld as decodeToJson,kd as flag,$d as id,Nd as randomStringWithEntropy,Gd as retrieve};
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
//# sourceMappingURL=shlClient.js.map
